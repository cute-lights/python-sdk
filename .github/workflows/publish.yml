# This file is autogenerated by maturin v1.7.0
# To update, run
#
#    maturin generate-ci github
#
name: CI

on:
    push:
        tags:
            - "*"
    pull_request:

permissions:
    contents: write

jobs:
    linux:
        runs-on: ${{ matrix.platform.runner }}
        strategy:
            matrix:
                platform:
                    - runner: ubuntu-latest
                      target: x86_64
        steps:
            - uses: actions/checkout@v4
            - uses: actions/setup-python@v5
              with:
                  python-version: 3.x

            - name: Bump version
              uses: cute-lights/bump-version@main
              with:
                  files: "Cargo.toml pyproject.toml"

            - name: Install Rust stable toolchain
              uses: actions-rs/toolchain@v1
              with:
                  profile: minimal
                  toolchain: stable
                  override: true

            - name: Install maturin
              run: python -m pip install maturin[patchelf]

            - name: Build wheels
              run: maturin build --release

            - name: Publish to PyPI
              shell: bash
              run: |
                  python -m pip install twine
                  python -m twine upload --skip-existing --verbose target/wheels/*.whl
